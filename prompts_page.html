<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>2026 香港自由行 - 獨旅/小團參考</title>
    <style>
        :root{--primary:#D35400;--accent:#E67E22;--bg:#F5F6FA;--card:#FFFFFF;--text:#2D3436;--sub:#636E72;--sunq:#16A34A;--jr:#DC2626;--dazaifu:#7C3AED;}
        @media (prefers-color-scheme: dark){:root{--bg:#1a1a1a;--card:#2d2d2d;--text:#ecf0f1;--sub:#bdc3c7;}}
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text);padding-bottom:80px;line-height:1.5;}

        /* 上方票券列 */
        .pass-bar{
            position:fixed;top:0;left:0;right:0;
            background:rgba(0,0,0,0.93);backdrop-filter:blur(15px);
            color:white;z-index:9999;
            padding:10px 12px;
            padding-top:max(env(safe-area-inset-top),22px);
            display:flex;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            flex-wrap: nowrap;
            justify-content: center;
            gap:10px;
        }
        .pass-tag{
            flex-shrink: 0; 
            min-width:98px;max-width:145px;
            padding:12px 10px;border-radius:18px;
            font-size:13px;font-weight:700;text-align:center;line-height:1.3;
            box-shadow:0 3px 10px rgba(0,0,0,0.4);
            transition:all .25s;cursor:pointer;
        }
        .pass-tag:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.5);}
        .pass-tag.sunq{background:var(--sunq);}
        .pass-tag.jr{background:var(--jr);}
        .pass-tag.dazaifu{background:var(--dazaifu);}
        .pass-tag.vjw{background:#2E86C1;}
        .pass-tag.emergency{background:#e74c3c;}
        
        /* 香港特定顏色調整 */
        .pass-tag.octopus{background:#F39C12;} /* 八達通橘 */
        .pass-tag.ael{background:#0072BC;} /* 機場快線藍 */

        /* 手機版調整 */
        @media (max-width:520px){
            .pass-bar{
                gap:8px;padding:8px 10px;padding-top:max(env(safe-area-inset-top),18px);
                justify-content: flex-start;
            }
            .pass-tag{font-size:12.5px;padding:10px 8px;min-width:80px;}
            header{margin-top:calc(env(safe-area-inset-top) + 85px);}
        }

        header{
            background:linear-gradient(135deg,var(--primary),var(--accent));
            color:white;padding:24px 20px;text-align:center;
            margin-top:calc(env(safe-area-inset-top) + 85px);
        }
        h1{font-size:25px;font-weight:800;margin:0;}
        .subtitle{font-size:15px;opacity:0.95;margin-top:6px;}

        /* FAB */
        .fab{
            position:fixed;bottom:max(22px,env(safe-area-inset-bottom));right:22px;
            background:var(--primary);color:white;
            width:58px;height:58px;border-radius:50%;
            display:flex;align-items:center;justify-content:center;
            box-shadow:0 5px 18px rgba(0,0,0,0.35);z-index:998;cursor:pointer;
            opacity:0;visibility:hidden;
            transition:all .4s cubic-bezier(0.4,0,0.2,1);
        }
        .fab.show{opacity:1;visibility:visible;}
        .fab:hover{transform:translateY(-6px);box-shadow:0 12px 28px rgba(211,84,0,0.5);}
        .fab svg{stroke:white;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;width:34px;height:34px;}

        /* Modal */
        .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:1000;justify-content:center;align-items:center;}
        .modal-content{background:var(--card);margin:20px;padding:24px;border-radius:16px;max-width:90%;max-height:85%;overflow-y:auto;box-shadow:0 12px 40px rgba(0,0,0,0.35);position:relative;text-align:center;}
        .close{position:absolute;top:8px;right:15px;font-size:32px;color:var(--sub);cursor:pointer;}

        #vjw-modal img {
            max-width: 250px;
            width: 85%;
            height: auto;
            margin: 15px auto;
            display: block;
            border: 4px solid var(--card);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* Timeline */
        .container{max-width:600px;margin:0 auto;padding:0 15px;}
        .day-group{margin:20px 0;}
        .day-header{background:var(--card);padding:16px;border-radius:14px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 3px 10px rgba(0,0,0,0.09);cursor:pointer;border-left:6px solid var(--primary);user-select:none;}
        .day-title{font-weight:bold;font-size:16.5px;}
        .toggle{font-size:24px;transition:transform .3s;}
        .active .toggle {transform: rotate(180deg);}
        .spots {display: none; padding-left: 14px;
            border-left: 2px solid #ddd; margin-left: 15px; margin-top: 12px;}
        .active .spots {display: block;}

        .spot {background: var(--card); margin: 14px 0 14px 16px; padding: 15px;
            border-radius: 14px; position: relative; box-shadow: 0 3px 8px rgba(0,0,0,0.07);}
        .spot::before {content: ''; position: absolute; left: -22px; top: 20px; width: 11px;
            height: 11px; border-radius: 50%; background: var(--sub); border: 2.5px solid var(--bg);}
        
        .spot.octopus::before {background: #F39C12;}
        .spot.ael::before {background: #0072BC;}

        .time {background: var(--card); color: var(--sub);
            padding: 4px 10px; border-radius: 6px; font-size: 11.5px; font-weight: 600; margin-bottom: 7px; display: inline-block;}
        .title {font-size: 16.5px; font-weight: 600; display: flex;
            align-items: center; justify-content: space-between;}
        .check {width: 21px; height: 21px; border: 2.5px solid #ccc; border-radius: 50%; margin-right: 11px; cursor: pointer;
            flex-shrink: 0;}
        .done .check {background: var(--primary); border-color: var(--primary); position: relative;}
        .done .check::after {content: '✓'; color: white; font-size: 13px; position: absolute; top: 50%;
            left: 50%; transform: translate(-50%, -50%);}
        .done .title {text-decoration: line-through; opacity: 0.6;}

        .content {font-size: 14px; color: var(--sub); line-height: 1.6;
            margin: 7px 0;}
        .content a {color: #3498db; text-decoration: underline;}

        .tags {display: flex; gap: 7px; flex-wrap: wrap; margin-top: 9px;
            font-size: 11.5px;}
        .tag {padding: 4px 9px; border-radius: 5px;}
        .tag.pass {background: #e8f5e9; color: #1a7431;}
        .tag.save {background: #f0f8ff; color: #0066cc; font-weight: 700;}

        .map {background: #3498db;
            color: white; padding: 5px 9px; border-radius: 5px; font-size: 10.5px; cursor: pointer;
            border: none;}

        footer {
            text-align: center;
            padding: 40px 20px;
            font-size: 13px;
            color: var(--sub);
            background: var(--bg);
            width: 100%;
            border-top: 1px solid rgba(0,0,0,0.05);
            margin-top: 40px;
        }
        footer p {
            margin: 8px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: bold;
            margin: 0 4px;
        }
        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div class="pass-bar" id="passBar"></div>

<div class="fab" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">
    <svg viewBox="0 0 24 24"><path d="M12 19V5M5 12l7-7 7 7"/></svg>
</div>

<div id="vjw-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeAllModals()">&times;</span>
        <h3>香港入境申報 (Arrival Card)</h3>
        <p style="margin-top:10px;font-size:14px;color:var(--sub)">請截圖保存 QR Code</p>
        <img id="vjw-img" src="" alt="Arrival Card">
        <p style="margin-top:10px;font-size:13px">建議提早於線上填寫香港入境申報表，或於機上領取紙本。</p>
    </div>
</div>

<div id="flight-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeAllModals()">&times;</span>
        <h3>班機資訊</h3>
        <div id="flight-info" style="white-space: pre-wrap; margin-top:15px; text-align:left; font-family:monospace; font-size:15px;"></div>
    </div>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeAllModals()">&times;</span>
        <h3 id="modal-title"></h3>
        <p id="modal-info" style="margin: 15px 0; text-align: left;"></p>
        <div id="modal-benefits" style="background:var(--bg); padding:10px; border-radius:8px; font-size:13px; text-align:left;"></div>
    </div>
</div>

<header>
    <h1 id="page-title"></h1>
    <div class="subtitle" id="page-subtitle"></div>
</header>

<div class="container" id="timeline"></div>
<footer id="footer"></footer>

<script>
// --- 資料設定 (香港版) ---
const tripData = {
  "title": "2026 香港 HK 自由行",
  "subtitle": "2/6 台北 TPE → 2/10 香港 HKG",
  "passes": {
    "octopus": {
      "tag": "八達通<br>Octopus",
      "title": "八達通卡 (Octopus)",
      "info": "香港必備交通神卡。<br>可用於：地鐵 (MTR)、巴士、叮叮車、渡輪、便利商店、餐廳付款。",
      "benefits": "全港通用，省去買票找零錢麻煩，必備！"
    },
    "ael": {
      "tag": "機場快線<br>來回",
      "title": "機場快線 (Airport Express)",
      "info": "往返香港機場與市區最快方式。<br>香港站約 24 分鐘，九龍站約 22 分鐘。",
      "benefits": "支援市區預辦登機（部分航空），快速舒適。"
    }
  },
  "vjw": {
    "enabled": true,
    "image": "https://www.gov.hk/tc/residents/immigration/control/images/arrival_card.jpg",
    "valid": "2026-02-06"
  },
  "emergency": {
    "title": "緊急電話（香港）",
    "info": "報案/火警/急救：999<br>台北經濟文化辦事處(香港)：<br>+852-2525-8316<br>急難救助：+852-6143-9012<br><br>信用卡掛失（台灣）：<br>國泰世華：+886-2-8073-1515<br>台新：+886-2-2655-3355<br>玉山：+886-2-2182-1313"
  },
  "flight": {
    "enabled": true,
    "info": "去程 2/6 (五) EVA AIR BR 871\n16:35 抵達 HKG 香港國際機場\n\n回程 2/10 (二) EVA AIR BR 810\n21:50 起飛 HKG → 23:35 抵達 TPE"
  },
  "footer": {
    "enabled": true,
    "text": "<p>© 2026 Created by <a href='#' target='_blank'>Travel Planner</a></p><p>本行程由 AI 輔助規劃並採用 <b>蔡大哥旅遊模板</b> 製作</p>"
  },
  "days": [
    {
      "d": "D1", "date": "2/6（五）", "title": "抵達香港 → 灣仔/銅鑼灣",
      "spots": [
        { "t": "16:35", "title": "抵達香港機場 HKG (BR 871)", "c": "領取行李、購買/儲值八達通<br><b onclick=\"closeAllModals();document.getElementById('flight-modal').style.display='flex'\">點這裡查看班機詳情</b>", "lat": 22.3080, "lng": 113.9185 },
        { "t": "17:30", "title": "機場快線 → 香港站/市區", "c": "約 24 分鐘直達", "pass": "機場快線", "type": "ael", "lat": 22.2854, "lng": 114.1578 },
        { "t": "19:00", "title": "晚餐：再興燒臘飯店", "c": "知名叉燒飯，灣仔平價米其林推薦", "lat": 22.2785, "lng": 114.1764 },
        { "t": "20:30", "title": "飯店 Check-in / 休息", "c": "整理行李，準備明日行程", "stay": true }
      ]
    },
    {
      "d": "D2", "date": "2/7（六）", "title": "佐敦早餐 → 太平山百萬夜景",
      "spots": [
        { "t": "09:00", "title": "早餐：澳洲牛奶公司", "c": "必點：炒蛋多士、燉奶。<br>佐敦站白加士街，排隊名店", "lat": 22.3044, "lng": 114.1706 },
        { "t": "11:00", "title": "尖沙咀/海港城 逛街", "c": "維多利亞港海濱漫步", "lat": 22.2950, "lng": 114.1669 },
        { "t": "16:00", "title": "前往中環花園道纜車站", "c": "準備搭纜車上山", "pass": "八達通", "type": "octopus", "lat": 22.2775, "lng": 114.1592 },
        { "t": "17:30", "title": "太平山頂 (Victoria Peak)", "c": "世界三大夜景之一，盧吉道展望台視野佳", "lat": 22.2759, "lng": 114.1455 },
        { "t": "19:30", "title": "晚餐：中環附近美食", "c": "下山後於中環覓食", "lat": 22.2819, "lng": 114.1581 }
      ]
    },
    {
      "d": "D3", "date": "2/8（日）", "title": "傳統飲茶 → 燒鵝名店",
      "spots": [
        { "t": "09:30", "title": "早茶：六安居 (蓮香居)", "c": "上環德輔道西。<br>保留傳統推車仔點心，懷舊氛圍濃", "lat": 22.2863, "lng": 114.1437 },
        { "t": "11:30", "title": "上環/中環 街區散策", "c": "石板街、大館、壁畫街", "lat": 22.2825, "lng": 114.1536 },
        { "t": "14:00", "title": "午茶：蘭芳園 (中環總店)", "c": "絲襪奶茶創始店，必喝！<br>結志街排檔風味", "lat": 22.2829, "lng": 114.1542 },
        { "t": "18:00", "title": "晚餐：甘牌燒鵝 (乾啤燒鵝)", "c": "灣仔米其林一星燒鵝。<br>(註：Excel紀錄為乾啤燒鵝，推測為此家)", "lat": 22.2778, "lng": 114.1756 }
      ]
    },
    {
      "d": "D4", "date": "2/9（一）", "title": "冰室體驗 → 叮叮車漫遊",
      "spots": [
        { "t": "09:30", "title": "早餐：華興冰室", "c": "傳統港式冰室早餐。<br>炒蛋、通粉、奶茶", "lat": 22.2850, "lng": 114.1360 },
        { "t": "11:00", "title": "體驗叮叮車 (電車)", "c": "搭乘電車慢遊港島街景", "pass": "八達通", "type": "octopus", "lat": 22.2820, "lng": 114.1500 },
        { "t": "13:00", "title": "銅鑼灣 / 灣仔 購物", "c": "時代廣場、SOGO", "lat": 22.2799, "lng": 114.1828 },
        { "t": "18:00", "title": "晚餐：市區自由覓食", "c": "車仔麵或雲吞麵", "stay": false }
      ]
    },
    {
      "d": "D5", "date": "2/10（二）", "title": "最後補貨 → 前往機場",
      "spots": [
        { "t": "11:00", "title": "市區預辦登機 / 最後採購", "c": "若搭乘機場快線可於香港/九龍站預掛行李", "pass": "機場快線", "type": "ael", "lat": 22.2854, "lng": 114.1578 },
        { "t": "18:30", "title": "抵達香港機場 HKG", "c": "保留時間退八達通(若需要)、免稅店", "lat": 22.3080, "lng": 113.9185 },
        { "t": "21:50", "title": "BR 810 起飛 HKG → TPE", "c": "<b onclick=\"closeAllModals();document.getElementById('flight-modal').style.display='flex'\">點這裡查看班機詳情</b>", "lat": 22.3080, "lng": 113.9185 }
      ]
    }
  ]
};

// --- 邏輯功能 ---

// 初始化頁面
document.addEventListener('DOMContentLoaded', () => {
    // 設定 Meta
    document.title = tripData.title;
    document.getElementById('page-title').textContent = tripData.title;
    document.getElementById('page-subtitle').textContent = tripData.subtitle;

    // 產生 Pass Bar
    const passBar = document.getElementById('passBar');
    
    // 1. Passes
    for (const [key, p] of Object.entries(tripData.passes)) {
        const div = document.createElement('div');
        div.className = `pass-tag ${key}`;
        div.innerHTML = p.tag;
        div.dataset.modal = key; 
        passBar.appendChild(div);
    }
    
    // 2. VJW (Arrival Card)
    if (tripData.vjw && tripData.vjw.enabled) {
        const div = document.createElement('div');
        div.className = 'pass-tag vjw';
        div.innerHTML = '入境申報<br>Arrival';
        div.onclick = toggleVjwModal;
        passBar.appendChild(div);
        document.getElementById('vjw-img').src = tripData.vjw.image;
    }
    
    // 3. Emergency
    if (tripData.emergency) {
        const div = document.createElement('div');
        div.className = 'pass-tag emergency';
        div.innerHTML = '緊急<br>SOS';
        div.dataset.modal = 'emergency';
        passBar.appendChild(div);
    }

    // 綁定 Modal 事件
    document.querySelectorAll('.pass-tag[data-modal]').forEach(el => {
        el.addEventListener('click', openModal);
    });

    // 填充 Flight Modal
    if (tripData.flight && tripData.flight.enabled) {
        document.getElementById('flight-info').textContent = tripData.flight.info;
    }

    // 產生 Footer
    if (tripData.footer && tripData.footer.enabled) {
        document.getElementById('footer').innerHTML = tripData.footer.text;
    }

    // 渲染行程
    render();
});

// 滾動監聽 FAB
window.addEventListener('scroll', () => {
    const fab = document.getElementById('backToTop');
    if (window.scrollY > 300) fab.classList.add('show');
    else fab.classList.remove('show');
});

function closeAllModals() {
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
    // 同時收合所有行程
    document.querySelectorAll('.day-group').forEach(d => d.classList.remove('active'));
}

function toggleVjwModal() {
    closeAllModals();
    const m = document.getElementById('vjw-modal');
    m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
}

function openModal(e) {
    e.stopPropagation(); // 防止冒泡
    const key = e.currentTarget.dataset.modal;
    let title = '', info = '', benefits = '';

    if (key === 'emergency' && tripData.emergency) {
        title = tripData.emergency.title;
        info = tripData.emergency.info;
        benefits = '';
    } else if (tripData.passes[key]) {
        title = tripData.passes[key].title;
        info = tripData.passes[key].info;
        benefits = tripData.passes[key].benefits;
    } else {
        return;
    }

    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-info').innerHTML = info;
    document.getElementById('modal-benefits').textContent = benefits || '';
    
    closeAllModals(); // 先關閉其他
    document.getElementById('modal').style.display = 'flex';
}

function toggleDay(event) {
    const group = event.currentTarget.parentElement;
    const isActive = group.classList.contains('active');
    
    // 單一展開：先收合所有
    document.querySelectorAll('.day-group').forEach(d => d.classList.remove('active'));
    
    // 若原本不是展開的，才展開當前
    if (!isActive) {
        group.classList.add('active');
        // 自動捲動到該日標題 (優化體驗)
        setTimeout(() => {
             const y = group.getBoundingClientRect().top + window.scrollY - 140;
             window.scrollTo({top: y, behavior: 'smooth'});
        }, 100);
    }
}

function openMap(lat, lng, name) {
    let query = name;
    // 簡單的正則補全關鍵字
    if (!/站|機場|神社|寺|市|市場|橋|城|湖|岳|宮|酒店|飯店|冰室|餐廳|樓|中心|廈/i.test(name)) {
        query += " 香港";
    }
    const url = `http://maps.google.com/maps?q=${encodeURIComponent(query)}&ll=${lat},${lng}`;
    window.open(url, '_blank');
}

function render() {
    const container = document.getElementById('timeline');
    let html = '';

    tripData.days.forEach(day => {
        let spotsHtml = '';
        day.spots.forEach(s => {
            // Tags
            let tags = '';
            if (s.pass) {
                if (s.cost && s.save) {
                    tags += `<span class="tag pass">${s.pass} 涵蓋 <s>¥${s.cost}</s></span> <span class="tag save">省 ¥${s.save}</span>`;
                } else {
                    tags += `<span class="tag pass">${s.pass} 涵蓋</span>`;
                }
            }
            
            // Map Button
            let mapBtn = '';
            if (s.lat && s.lng) {
                mapBtn = `<button class="map" onclick="event.stopPropagation();openMap(${s.lat},${s.lng},'${s.title.replace(/'/g,"\\'")}')">地圖</button>`;
            }

            // Spot Type Class
            const typeClass = s.type ? ` ${s.type}` : '';

            spotsHtml += `
            <div class="spot${typeClass}" onclick="this.classList.toggle('done')">
                <div class="time">${s.t}</div>
                <div class="title">
                    <div style="display:flex;align-items:center">
                        <div class="check"></div>
                        <span>${s.title}</span>
                    </div>
                    ${mapBtn}
                </div>
                <div class="content">${s.c}</div>
                <div class="tags">${tags}</div>
            </div>`;
        });

        html += `
        <div class="day-group">
            <div class="day-header" onclick="toggleDay(event)">
                <div class="day-title">${day.d} ${day.title}</div>
                <div style="display:flex;align-items:center;gap:10px;">
                    <div style="font-size:12px;color:var(--sub)">${day.date}</div>
                    <div class="toggle">▼</div>
                </div>
            </div>
            <div class="spots">
                ${spotsHtml}
            </div>
        </div>`;
    });

    container.innerHTML = html;
}
</script>
</body>
</html>