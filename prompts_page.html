<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>2026 æ¸¯æ¾³ 5æ—¥éŠ - TsaiBigBrother</title>
    <style>
/* TsaiBigBrother Style Variables */
:root{--primary:#D35400;--accent:#E67E22;--bg:#F5F6FA;--card:#FFFFFF;--text:#2D3436;--sub:#636E72;--sunq:#16A34A;--jr:#DC2626;--dazaifu:#7C3AED;--money:#27AE60;--cotai:#0056b3;}
@media (prefers-color-scheme: dark){:root{--bg:#1a1a1a;--card:#2d2d2d;--text:#ecf0f1;--sub:#bdc3c7;}}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text);padding-bottom:80px;line-height:1.5;}

/* ä¸Šæ–¹ç¥¨åˆ¸åˆ— */
.pass-bar{
    position:fixed;top:0;left:0;right:0;
    background:rgba(0,0,0,0.93);backdrop-filter:blur(15px);
    color:white;z-index:9999;
    padding:10px 12px;
    padding-top:max(env(safe-area-inset-top),22px);
    display:flex;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    flex-wrap: nowrap;
    justify-content: center;
    gap:10px;
}
.pass-tag{
    flex-shrink: 0; 
    min-width:98px;max-width:145px;
    padding:12px 10px;border-radius:18px;
    font-size:13px;font-weight:700;text-align:center;line-height:1.3;
    box-shadow:0 3px 10px rgba(0,0,0,0.4);
    transition:all .25s;cursor:pointer;
}
.pass-tag:active{transform:translateY(2px);}
.pass-tag.sunq{background:var(--sunq);}
.pass-tag.jr{background:var(--jr);}
.pass-tag.cotai{background:var(--cotai);}
.pass-tag.dazaifu{background:var(--dazaifu);}
.pass-tag.money{background:var(--money);}
.pass-tag.emergency{background:#e74c3c;}

/* æ‰‹æ©Ÿç‰ˆèª¿æ•´ */
@media (max-width:520px){
    .pass-bar{
        gap:8px;padding:8px 10px;padding-top:max(env(safe-area-inset-top),18px);
        justify-content: flex-start;
    }
    .pass-tag{font-size:12.5px;padding:10px 8px;min-width:80px;}
    header{margin-top:calc(env(safe-area-inset-top) + 85px);}
}

header{
    background:linear-gradient(135deg,var(--primary),var(--accent));
    color:white;padding:24px 20px;text-align:center;
    margin-top:calc(env(safe-area-inset-top) + 85px);
}
h1{font-size:25px;font-weight:800;margin:0;}
.subtitle{font-size:15px;opacity:0.95;margin-top:6px;}

/* FAB */
.fab{
    position:fixed;bottom:max(22px,env(safe-area-inset-bottom));right:22px;
    background:var(--primary);color:white;
    width:58px;height:58px;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    box-shadow:0 5px 18px rgba(0,0,0,0.35);z-index:998;cursor:pointer;
    opacity:0;visibility:hidden;
    transition:all .4s cubic-bezier(0.4,0,0.2,1);
}
.fab.show{opacity:1;visibility:visible;}
.fab svg{stroke:white;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;width:34px;height:34px;}

/* Modal */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:1000;justify-content:center;align-items:center;}
.modal-content{background:var(--card);margin:20px;padding:24px;border-radius:16px;max-width:90%;max-height:85%;overflow-y:auto;box-shadow:0 12px 40px rgba(0,0,0,0.35);position:relative;text-align:center;}
.close{position:absolute;top:8px;right:15px;font-size:32px;color:var(--sub);cursor:pointer;}

#vjw-modal img {
    max-width: 250px;
    width: 85%;
    height: auto;
    margin: 15px auto;
    display: block;
    border: 4px solid var(--card);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Timeline */
.container{max-width:600px;margin:0 auto;padding:0 15px;}
.day-group{margin:20px 0;}
.day-header{background:var(--card);padding:16px;border-radius:14px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 3px 10px rgba(0,0,0,0.09);cursor:pointer;border-left:6px solid var(--primary);user-select:none;}
.day-title{font-weight:bold;font-size:16.5px;}
.toggle{font-size:24px;transition:transform .3s;}
.active .toggle {transform: rotate(180deg);}
.spots {display: none; padding-left: 14px; border-left: 2px solid #ddd; margin-left: 15px; margin-top: 12px;}
.active .spots {display: block;}

.spot {background: var(--card); margin: 14px 0 14px 16px; padding: 15px; border-radius: 14px; position: relative; box-shadow: 0 3px 8px rgba(0,0,0,0.07);}
.spot::before {content: ''; position: absolute; left: -22px; top: 20px; width: 11px; height: 11px; border-radius: 50%; background: var(--sub); border: 2.5px solid var(--bg);}
.spot.sunq::before {background: var(--sunq);}
.spot.jr::before {background: var(--jr);}
.spot.cotai::before {background: var(--cotai);}
.spot.dazaifu::before {background: var(--dazaifu);}
.spot.money::before {background: var(--money);}

.time {background: var(--card); color: var(--sub); padding: 4px 10px; border-radius: 6px; font-size: 11.5px; font-weight: 600; margin-bottom: 7px; display: inline-block;}
.title {font-size: 16.5px; font-weight: 600; display: flex; align-items: center; justify-content: space-between;}
.check {width: 21px; height: 21px; border: 2.5px solid #ccc; border-radius: 50%; margin-right: 11px; cursor: pointer; flex-shrink: 0;}
.done .check {background: var(--primary); border-color: var(--primary); position: relative;}
.done .check::after {content: 'âœ“'; color: white; font-size: 13px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}
.done .title {text-decoration: line-through; opacity: 0.6;}

.content {font-size: 14px; color: var(--sub); line-height: 1.6; margin: 7px 0;}
.content a {color: #3498db; text-decoration: underline;}

.tags {display: flex; gap: 7px; flex-wrap: wrap; margin-top: 9px; font-size: 11.5px;}
.tag {padding: 4px 9px; border-radius: 5px;}
.tag.pass {background: #e8f5e9; color: #1a7431;}
.tag.save {background: #f0f8ff; color: #0066cc; font-weight: 700;}
.tag.alert {background: #fef2f2; color: #dc2626; font-weight: 700;}

.map {background: #3498db; color: white; padding: 5px 9px; border-radius: 5px; font-size: 10.5px; cursor: pointer; border: none;}

/* Distance & Icon */
.dist-display {
    font-size: 12px;
    color: var(--primary);
    margin-top: 6px;
    display: flex;
    align-items: center;
    font-weight: 500;
}
.dist-icon {
    font-size: 14px;
    margin-right: 4px;
    width: 20px;
    text-align: center;
}

/* Footer */
footer {
    text-align: center;
    padding: 40px 20px;
    font-size: 13px;
    color: var(--sub);
    background: var(--bg);
    width: 100%;
    border-top: 1px solid rgba(0,0,0,0.05);
    margin-top: 40px;
}
footer p {
    margin: 8px 0;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
}
footer a {
    color: var(--primary);
    text-decoration: none;
    font-weight: bold;
    margin: 0 4px;
}
    </style>
</head>
<body>

<div class="pass-bar" id="passBar"></div>
<div class="fab" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 15l-6-6-6 6"/></svg>
</div>

<div id="vjw-modal" class="modal" onclick="toggleVjwModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="close" onclick="toggleVjwModal()">Ã—</span>
        <h3>å…¥å¢ƒ QR Code</h3>
        <div id="vjw-img-container"></div>
        <p style="margin-top:15px;font-size:13px;color:var(--sub)">è«‹æˆªåœ–ä¿å­˜ä»¥å‚™é›¢ç·šä½¿ç”¨</p>
    </div>
</div>

<div id="flight-modal" class="modal" onclick="closeAllModals()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="close" onclick="closeAllModals()">Ã—</span>
        <h3>ç­æ©Ÿè³‡è¨Š</h3>
        <p id="flight-info" style="white-space: pre-line; margin-top:15px; text-align:left; line-height:1.6;"></p>
    </div>
</div>

<div id="modal" class="modal" onclick="closeAllModals()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="close" onclick="closeAllModals()">Ã—</span>
        <h3 id="modal-title"></h3>
        <p id="modal-info" style="margin:15px 0;line-height:1.6;"></p>
        <p id="modal-benefits" style="color:var(--primary);font-weight:bold;font-size:14px;"></p>
    </div>
</div>

<header>
    <h1 id="header-title"></h1>
    <div class="subtitle" id="header-subtitle"></div>
</header>

<div class="container" id="timeline"></div>

<footer id="footer"></footer>

<script>
const tripData = {
  "title": "2026 æ¸¯æ¾³ 5æ—¥éŠ - TsaiBigBrother",
  "subtitle": "2/6 TPEâ†’HKG (BR871) | 2/10 HKGâ†’TPE (BR810)",
  "passes": {
    "money": {
      "tag": "æ›åŒ¯æ”»ç•¥<br>é€±å…­æ³¨æ„",
      "title": "ğŸ’° æ¸¯æ¾³æ›éŒ¢æ”»ç•¥",
      "info": "<div style='text-align:left;'><b>âš ï¸ é€±å…­ä¸‹åˆ 1-2 é»å¾Œï¼ŒåŒ¯ç‡å„ªçš„è€åº—æœƒé—œé–€ï¼</b><br><br><b>1. D1 é€±äº”æ™š (æ©Ÿå ´)ï¼š</b><br>ä½¿ç”¨ ATM (éŠ€é€š/HSBC) æé ˜å°‘é‡ç¾é‡‘ã€‚<br><br><b>2. D2 é€±å…­æ—© (09:00-13:00)ï¼š</b><br>ğŸ“ <b>ä¸Šç’°ç‰›è¨˜</b> æˆ– <b>å°–æ²™å’€å …æˆ</b> (åŒ¯ç‡æœ€å„ª)ã€‚<br><br><b>3. D2 é€±å…­åˆ (14:00å¾Œ)ï¼š</b><br>ğŸ“ <b>æ²¹éº»åœ°é£›é³¥æ‰¾æ›</b> (é–‹åˆ°æ™šä¸Š) æˆ– é‡æ…¶å¤§å»ˆå…§éƒ¨åº—å®¶ã€‚<br><br>ğŸ’¡ æ¾³é–€é€šç”¨æ¸¯å¹£ï¼Œä¸éœ€ç‰¹åœ°æ›æ¾³é–€å¹£ã€‚</div>",
      "benefits": "å‹™å¿…æ³¨æ„é€±å…­ç‡Ÿæ¥­æ™‚é–“ï¼"
    },
    "cotai": {
      "tag": "é‡‘å…‰é£›èˆª<br>å»ç¨‹",
      "title": "é‡‘å…‰é£›èˆª (Cotai Water Jet)",
      "info": "é¦™æ¸¯ä¸Šç’° 07:30 â†’ æ¾³é–€æ°¹ä»” 08:30ã€‚<br>ä¸‹èˆ¹å¾Œå¯ç›´æ¥å‰å¾€å¨å°¼æ–¯äºº/å€«æ•¦äººï¼ˆæœ‰å…è²»æ¥é§è»Šï¼‰ã€‚",
      "benefits": "è—è‰²èˆ¹èº«ï¼Œå‰å¾€æ°¹ä»”é¦–é¸"
    },
    "jr": {
      "tag": "å™´å°„é£›èˆª<br>å›ç¨‹",
      "title": "å™´å°„é£›èˆª (TurboJET)",
      "info": "æ¾³é–€å¤–æ¸¯ç¢¼é ­ â†’ é¦™æ¸¯ä¸Šç’°ã€‚<br>ç´…è‰²èˆ¹èº«ã€‚é©åˆå¾æ¾³é–€åŠå³¶ï¼ˆå¤§ä¸‰å·´ã€æ¼äººç¢¼é ­ï¼‰å›ç¨‹ä½¿ç”¨ã€‚",
      "benefits": "ç´…è‰²èˆ¹èº«ï¼Œå¾€è¿”åŠå³¶é¦–é¸"
    },
    "sunq": {
      "tag": "å…«é”é€š<br>å…¨æ¸¯é€š",
      "title": "å…«é”é€š (Octopus)",
      "info": "é¦™æ¸¯å¿…å‚™ï¼åœ°éµã€å·´å£«ã€æ¸¡è¼ªã€ä¾¿åˆ©å•†åº—ã€é¤å»³çš†é€šç”¨ã€‚<br>å»ºè­°æ–¼æ©Ÿå ´å¿«ç·šæ«ƒå°æˆ–ä¾¿åˆ©å•†åº—è³¼è²·ã€‚",
      "benefits": "å…¨æ¸¯é€šç”¨ï¼Œçœå»è³¼ç¥¨æ™‚é–“"
    },
    "dazaifu": {
      "tag": "æ˜‚åª360<br>çºœè»Š",
      "title": "æ˜‚åª 360 çºœè»Š",
      "info": "æ±æ¶Œ â†” æ˜‚åªå¸‚é›†ã€‚<br>å»ºè­°è³¼è²·æ°´æ™¶è»Šå»‚ï¼Œè¦–é‡æ¥µä½³ï¼Œå¯ä¿¯ç°å¤§å¶¼å±±èˆ‡æ©Ÿå ´ã€‚",
      "benefits": "ç†±é–€æ™¯é»ï¼Œå»ºè­°é ç´„"
    }
  },
  "vjw": {
    "enabled": false,
    "image": "",
    "valid": ""
  },
  "emergency": {
    "title": "ç·Šæ€¥è¯çµ¡ï¼ˆæ¸¯æ¾³ï¼‰",
    "info": "é¦™æ¸¯å ±æ¡ˆ/ç«è­¦/æ€¥æ•‘ï¼š999<br>æ¾³é–€å ±æ¡ˆ/ç«è­¦/æ€¥æ•‘ï¼š999<br>å°åŒ—é§é¦™æ¸¯è¾¦äº‹è™•ï¼š+852-2525-8316<br>å°åŒ—é§æ¾³é–€è¾¦äº‹è™•ï¼š+853-2830-6289"
  },
  "flight": {
    "enabled": true,
    "info": "å»ç¨‹ BR871 (EVA AIR)\n2/6 16:35 TPE â†’ 18:30 HKG\n\nå›ç¨‹ BR810 (EVA AIR)\n2/10 21:50 HKG â†’ 23:35 TPE"
  },
  "footer": {
    "enabled": true,
    "text": "<p>Â© 2026 Created by <a href='#' target='_blank'>TsaiBigBrother è”¡å¤§å“¥</a></p><p>æœ¬è¡Œç¨‹ç”± AI è¼”åŠ©è¦åŠƒä¸¦æ¡ç”¨ <b>è”¡å¤§å“¥æ—…éŠæ¨¡æ¿</b> è£½ä½œ</p>"
  },
  "days": [
    {
      "d": "D1", "date": "2/6ï¼ˆäº”ï¼‰", "title": "æŠµé”é¦™æ¸¯ â†’ ç£ä»”é›¨å‚™",
      "spots": [
        { "t": "16:35", "title": "TPE èµ·é£› (BR871)", "c": "é è¨ˆ 18:30 æŠµé” HKG<br><b onclick=\"closeAllModals();document.getElementById('flight-modal').style.display='flex'\">é»é€™è£¡æŸ¥çœ‹ç­æ©Ÿè³‡è¨Š</b>", "lat": 25.0797, "lng": 121.2342, "move": "plane" },
        { "t": "18:30", "title": "æŠµé”é¦™æ¸¯æ©Ÿå ´ HKG", "c": "é€šé—œï¼‹è¡Œæç´„45åˆ†ã€‚å‰å¾€æ©Ÿå ´å¿«ç·š/å·´å£«ç«™ã€‚", "lat": 22.3080, "lng": 113.9185, "move": "walk" },
        { "t": "19:30", "title": "å‰å¾€ç£ä»” å…­åœ‹é…’åº—", "c": "æ­ä¹˜ A11 å·´å£«æˆ–æ©Ÿå ´å¿«ç·šè½‰åœ°éµè‡³ç£ä»”ç«™ã€‚", "pass": "å…«é”é€š", "type": "sunq", "lat": 22.2783, "lng": 114.1717, "move": "bus" },
        { "t": "20:30", "title": "æ™šé¤ï¼šé å¾—ä½ç²¥éºµ", "c": "<b>è¡Œç¨‹å„ªåŒ–ï¼</b>å†èˆˆ/è¯æ˜Ÿéƒ½å·²é—œé–€æˆ–å”®å®Œã€‚æ”¹åƒé€™å®¶<b>ç±³å…¶æ—å¿…æ¯”ç™»æ¨è–¦</b>ï¼Œé–‹åˆ°23:45ï¼Œè±¬è‚ç²¥/é®®è¦é›²åéºµå¿…é»ã€‚å°±åœ¨é£¯åº—é™„è¿‘ã€‚", "lat": 22.2775, "lng": 114.1740, "save": "Safe", "move": "walk" },
        { "t": "22:00", "title": "æ›éŒ¢æ‰€ & æ¡è²·", "c": "ç£ä»”å€æ‰¾æ›åº—åŒ¯ç‡æ™®é€šï¼Œå»ºè­°å…ˆæ›å°‘é‡ã€‚", "type": "money", "lat": 22.2770, "lng": 114.1725, "move": "walk" }
      ]
    },
    {
      "d": "D2", "date": "2/7ï¼ˆå…­ï¼‰", "title": "ä¸­ç’°æ–‡è— & ç‡’éµæ‰“å°äºº",
      "spots": [
        { "t": "09:00", "title": "æ—©é¤ï¼šå…­å®‰å±… (åŸè“®é¦™å±…)", "c": "ä¸Šç’°ã€‚é«”é©—å‚³çµ±æ¨è»Šé»å¿ƒã€‚06:00å°±é–‹äº†ï¼Œä¸ç”¨æ“”å¿ƒã€‚", "lat": 22.2872, "lng": 114.1485, "move": "mtr" },
        { "t": "10:00", "title": "ğŸ”¥ æ›åŒ¯é¦–é¸ï¼šç‰›è¨˜æ‰¾æ›", "c": "<b>é€±å…­ 13:00 é—œé–€ï¼</b>å°±åœ¨ä¸Šç’°ã€‚è‹¥æ²’é–‹è«‹å»å°–æ²™å’€å …æˆ(é–‹åˆ°14:00)æˆ–æ²¹éº»åœ°é£›é³¥(é–‹åˆ°æ™šä¸Š)ã€‚", "type": "money", "lat": 22.2865, "lng": 114.1515, "move": "walk" },
        { "t": "10:30", "title": "ä¸­ç’°åŠå±±æ‰¶æ‰‹é›»æ¢¯", "c": "é€”ç¶“ï¼šçŸ³æ¿è¡—ã€å˜‰å’¸è¡—å£ç•«ã€å¤§é¤¨ã€‚", "lat": 22.2830, "lng": 114.1550, "move": "walk" },
        { "t": "12:00", "title": "ä¼´æ‰‹ç¦®ï¼šçå¦®æ›²å¥‡ & æª¸æª¬ç‹", "c": "ä¸Šç’°æ°¸å’Œè¡—ã€‚è²·å®Œå»ºè­°å…ˆå¯„ç‰©æˆ–å›é£¯åº—ã€‚", "lat": 22.2855, "lng": 114.1520, "move": "walk" },
        { "t": "13:00", "title": "åˆé¤ï¼šå‹é¦™åœ’", "c": "ä¸­ç’°å¤§æ’æª”ã€‚ç•ªèŒ„é€šç²‰ã€‚(é€±æ—¥ä¸é–‹ï¼Œä»Šæ—¥ä¾†æ˜¯å°çš„)", "lat": 22.2843, "lng": 114.1528, "move": "walk" },
        { "t": "15:00", "title": "æ€ªç¸å¤§å»ˆ (æµ·å±±æ¨“)", "c": "åœ°éµå¤ªå¤ç«™ã€‚æ‰“å¡ç†±é»ã€‚", "lat": 22.2842, "lng": 114.2124, "move": "mtr" },
        { "t": "17:30", "title": "æ™šé¤ï¼šç”˜ç‰Œç‡’éµ / å†èˆˆ", "c": "<b>å‹•ç·šå„ªåŒ–ï¼</b>å…ˆåœ¨ç£ä»”åƒé£¯ï¼Œé¿é–‹è¶Šæ™šæ’è¶Šé•·ã€‚ç”˜ç‰Œéœ€æ’éšŠï¼Œå†èˆˆè¼ƒå¿«ã€‚åƒé£½å‰›å¥½å°±åœ¨é™„è¿‘æ‰“å°äººã€‚", "lat": 22.2780, "lng": 114.1750, "save": "å„ªå…ˆ", "move": "taxi" },
        { "t": "19:00", "title": "éµé ¸æ©‹æ‰“å°äºº", "c": "<b>é †è·¯è¡Œç¨‹ï¼</b>å¾ç‡’è‡˜åº—èµ°éä¾†ç´„5-8åˆ†ã€‚å°±åœ¨ç£ä»”/éŠ…é‘¼ç£äº¤ç•Œï¼Œæ‰“å®Œå»ä¸­ç’°çœ‹å¤œæ™¯å‰›å‰›å¥½ã€‚", "lat": 22.2798, "lng": 114.1815, "save": "é †è·¯", "move": "walk" },
        { "t": "19:45", "title": "å¤ªå¹³å±±é ‚çºœè»Š", "c": "ä¸­ç’°èŠ±åœ’é“ã€‚<b>å·²è³¼è²·å¿«é€šï¼</b>é€™æ™‚é–“ä¸Šå±±å‰›å¥½çœ‹åˆ°ç™¾è¬å¤œæ™¯ã€‚", "pass": "å±±é ‚çºœè»Š", "type": "dazaifu", "lat": 22.2775, "lng": 114.1585, "move": "taxi" },
        { "t": "21:30", "title": "è˜­æ¡‚åŠ (Lan Kwai Fong)", "c": "<b>é€±å…­å¤œç”Ÿæ´»ï¼</b>ä¸‹å±±å¾Œç›´æ¥åˆ°ä¸­ç’°å–ä¸€æ¯ï¼Œå‹•ç·šä¸èµ°å›é ­è·¯ã€‚", "lat": 22.2810, "lng": 114.1555, "move": "walk" }
      ]
    },
    {
      "d": "D3", "date": "2/8ï¼ˆæ—¥ï¼‰", "title": "é»ƒå¤§ä»™ç¥ˆç¦ & è³½é¦¬æ—¥",
      "spots": [
        { "t": "08:30", "title": "æ—©é¤ï¼šæ¾³æ´²ç‰›å¥¶å…¬å¸", "c": "ä½æ•¦ã€‚07:30é–‹é–€ã€‚ææ—©å‡ºç™¼é¿é–‹äººæ½®ã€‚", "lat": 22.3046, "lng": 114.1705, "move": "mtr" },
        { "t": "09:45", "title": "é»ƒå¤§ä»™ç¥  (Wong Tai Sin)", "c": "07:30é–‹é–€ã€‚é¦™ç«æœ€é¼ç››ï¼Œæ±‚ç±¤éˆé©—ã€‚", "lat": 22.3426, "lng": 114.1934, "move": "mtr" },
        { "t": "11:30", "title": "æ²™ç”°é¦¬å ´ (Racecourse)", "c": "åœ°éµé¦¬å ´ç«™ã€‚é€±æ—¥è³½äº‹ç´„12:45é–‹å§‹ï¼Œç¾åœ¨é€²å ´å‰›å¥½ã€‚", "lat": 22.4000, "lng": 114.2050, "move": "mtr" },
        { "t": "15:30", "title": "åˆç›Šæ³°å°é£Ÿ (æ·±æ°´åŸ—)", "c": "é–‹åˆ°20:00ã€‚å¿…æ¯”ç™»æ¨è–¦è…¸ç²‰ã€‚", "lat": 22.3308, "lng": 114.1610, "save": "å¿…åƒ", "move": "mtr" },
        { "t": "17:00", "title": "æ—ºè§’è¡—é ­ï¼šé€šé” & è‚¥å§", "c": "1. é€šé”é£Ÿåº—ï¼šå’–å“©é­šè›‹<br>2. è‚¥å§å°é£Ÿåº—ï¼šå†·æ»·å‘³", "lat": 22.3195, "lng": 114.1694, "move": "mtr" },
        { "t": "19:00", "title": "ç¶­å¤šåˆ©äºæ¸¯ & æ˜Ÿå…‰å¤§é“", "c": "å°–æ²™å’€æµ·æ—ã€‚æ•£æ­¥çœ‹å¤œæ™¯ã€‚", "lat": 22.2935, "lng": 114.1730, "move": "bus" },
        { "t": "20:30", "title": "æ™šé¤ï¼šå»Ÿè¡—å¤œå¸‚", "c": "èˆˆè¨˜ç…²ä»”é£¯ã€‚æ„Ÿå—å¤§æ’æª”ã€‚", "lat": 22.3060, "lng": 114.1695, "move": "walk" },
        { "t": "22:00", "title": "ç”œé»ï¼šä½³ä½³ç”œå“", "c": "é–‹åˆ°å‡Œæ™¨ã€‚ä½æ•¦å¯§æ³¢è¡—ã€‚", "lat": 22.3048, "lng": 114.1685, "save": "å¿…åƒ", "move": "walk" }
      ]
    },
    {
      "d": "D4", "date": "2/9ï¼ˆä¸€ï¼‰", "title": "æ¾³é–€ï¼šç››è¨˜ç™½ç²¥ & å®˜ä¹Ÿè¡—",
      "spots": [
        { "t": "07:30", "title": "é¦™æ¸¯ä¸Šç’° â†’ æ¾³é–€æ°¹ä»” (é‡‘å…‰é£›èˆª)", "c": "<b>å·²è³¼ç¥¨ï¼</b>07:30 ä¸Šç’°é–‹èˆ¹ã€‚é è¨ˆ 08:30 æŠµé”æ°¹ä»”å®¢é‹ç¢¼é ­ã€‚", "pass": "Cotai Jet", "type": "cotai", "lat": 22.2885, "lng": 114.1520, "move": "mtr" },
        { "t": "09:00", "title": "æ—©é¤ï¼šç››è¨˜ç™½ç²¥ (æ°¹ä»”åº—)", "c": "<b>å®Œç¾éŠœæ¥ï¼</b>ä¸‹èˆ¹å¾Œç›´æ¥æ­è¨ˆç¨‹è»Šä¾†(ç´„10åˆ†)ã€‚<br>å¿…é»ï¼šç™½ç²¥ã€è˜¿è””ç³•ã€è±†è…èŠ± (æ¸…æ·¡é–‹èƒƒ)ã€‚", "lat": 22.1585, "lng": 113.5535, "save": "æ–°åŠ å…¥", "move": "taxi" },
        { "t": "10:15", "title": "å¨å°¼æ–¯äºº & å€«æ•¦äºº", "c": "åƒé£½å¾Œæ­¥è¡Œæˆ–çŸ­ç¨‹è»Šéå»ã€‚è¶æ—©ä¸Šäººæ½®è¼ƒå°‘ï¼Œå…ˆæ‹å€«æ•¦äººå¤§ç¬¨é˜èˆ‡å¨å°¼æ–¯äººé‹æ²³ã€‚", "lat": 22.1470, "lng": 113.5600, "move": "walk" },
        { "t": "11:30", "title": "å®˜ä¹Ÿè¡— & å®‰å¾·é­¯è›‹å¡”", "c": "<b>è¡Œç¨‹åŠ ç¢¼ï¼</b>å¾å¨å°¼æ–¯äººè¥¿ç¿¼ä½¿ç”¨ã€Œè‡ªå‹•æ­¥è¡Œç³»çµ±ã€å³å¯æŠµé”ã€‚å¿…è²·å®‰å¾·é­¯è›‹å¡”ï¼", "lat": 22.1538, "lng": 113.5573, "save": "å¿…å»", "move": "walk" },
        { "t": "12:45", "title": "å‰å¾€æ¾³é–€åŠå³¶ (å…¬è»Š)", "c": "<b>äº¤é€šæ”»ç•¥ï¼š</b>èµ°åˆ°å®˜ä¹Ÿè¡—å°¾ç«¯ Starbucks æ—<br>1. ä¸Šè»Šï¼š<b>T323 é»‘æ©‹/åœ°å ¡è¡—</b> (æ­ 33 æˆ– 26A)<br>2. ä¸‹è»Šï¼š<b>M171 ä¸­å€/æ®·çš‡å­é¦¬è·¯</b> (ç´„20åˆ†)", "lat": 22.1540, "lng": 113.5560, "move": "bus" },
        { "t": "13:30", "title": "åˆé¤ï¼šé™³å…‰è¨˜ç‡’è‡˜", "c": "<b>æ­¥è¡Œå°èˆªï¼š</b>å…¬è»Šç«™ä¸‹è»Šå¾Œå¾€å›èµ°ï¼Œçœ‹åˆ°ã€Œå‘¨å¤§ç¦ã€å·¦è½‰ç¾…ä¿åšå£«è¡—å³é”ã€‚é»‘æ¤’ç‡’é´¨å¿…é»ã€‚", "lat": 22.1921, "lng": 113.5424, "save": "å¿…åƒ", "move": "walk" },
        { "t": "14:30", "title": "å¤§ä¸‰å·´ & æ­·å²åŸå€", "c": "æ­¥è¡ŒéŠè¦½ï¼šè­°äº‹äº­å‰åœ°ã€ç«ç‘°å ‚ã€å¤§ä¸‰å·´ç‰ŒåŠã€æˆ€æ„›å··ã€‚", "lat": 22.1975, "lng": 113.5405, "move": "walk" },
        { "t": "16:30", "title": "æ¼äººç¢¼é ­ / é‡‘è“®èŠ±å»£å ´", "c": "åŠå³¶é †éŠæ™¯é»ã€‚ç¾…é¦¬ç«¶æŠ€å ´é¢¨æ ¼ï¼Œé©åˆæ‹ç…§ã€‚", "lat": 22.1930, "lng": 113.5560, "move": "bus" },
        { "t": "18:00", "title": "æ™šé¤ï¼šç•ªèŒ„å±‹ (Tomato)", "c": "<b>åœ¨åœ°æ¨è–¦ï¼</b>å°±åœ¨å¤§ä¸‰å·´æ—å“ªå’å»Ÿæ–œå··ã€‚CPå€¼æ¥µé«˜ï¼Œé©åˆå…©äººç”¨é¤ (ç´„$100-150)ã€‚", "lat": 22.1977, "lng": 113.5401, "save": "é«˜CP", "move": "walk" },
        { "t": "20:30", "title": "å‰å¾€å¤–æ¸¯ç¢¼é ­", "c": "æ™šé¤å¾Œæ­è»Šå‰å¾€å¤–æ¸¯ç¢¼é ­ (ç´„ 10-15 åˆ†)ã€‚", "lat": 22.1965, "lng": 113.5555, "move": "taxi" },
        { "t": "21:00", "title": "è¿”ç¨‹ï¼šæ¾³é–€å¤–æ¸¯ â†’ é¦™æ¸¯ä¸Šç’°", "c": "æ­ä¹˜<b>å™´å°„é£›èˆª (TurboJET)</b>ã€‚è¿”å›é¦™æ¸¯ã€‚", "pass": "TurboJET", "type": "jr", "lat": 22.1965, "lng": 113.5555, "move": "ship" }
      ]
    },
    {
      "d": "D5", "date": "2/10ï¼ˆäºŒï¼‰", "title": "å¤§å¶¼å±± & æ©Ÿå ´è¡åˆº",
      "spots": [
        { "t": "08:30", "title": "æ—©é¤ï¼šè¯æ˜Ÿå†°å®¤", "c": "<b>å®Œç¾å®‰æ’ï¼</b>å°±åœ¨ç£ä»”é£¯åº—æ—ã€‚é»‘æ¾éœ²ç‚’è›‹å¤šå£«ã€‚åƒé£½å†é€€æˆ¿ã€‚", "lat": 22.2780, "lng": 114.1760, "save": "æ–°åŠ å…¥", "move": "walk" },
        { "t": "09:30", "title": "é£¯åº— Check-out", "c": "æ­åœ°éµ/å·´å£«å‰å¾€æ±æ¶Œ (ç´„ 50 åˆ†)ã€‚", "lat": 22.2783, "lng": 114.1717, "move": "walk" },
        { "t": "10:30", "title": "æ±æ¶Œ Citygate å¯„ç‰©", "c": "åœ°éµæ±æ¶Œç«™ B2 æˆ–å—é¢ç½®ç‰©æ«ƒã€‚<br><b style='color:#d35400'>æ³¨æ„ï¼š</b>08:00é–‹å§‹ç‡Ÿæ¥­ã€‚æ—©é»åˆ°æ¯”è¼ƒæœ‰å¤§æ«ƒä½ã€‚", "lat": 22.2895, "lng": 113.9410, "save": "é—œéµ", "move": "mtr" },
        { "t": "11:00", "title": "æ˜‚åª 360 çºœè»Š", "c": "æ°´æ™¶è»Šå»‚ã€‚æŠµé”æ˜‚åªç«™å¾Œï¼Œç©¿è¶Šæ˜‚åªå¸‚é›†(ç´„10åˆ†)å³å¯è¦‹åˆ°å¤§ä½›ï¼Œå¯é¸æ“‡æŒ‘æˆ°268ç´šéšæ¢¯ã€‚", "pass": "æ˜‚åªçºœè»Š", "type": "dazaifu", "lat": 22.2905, "lng": 113.9385, "move": "cable" },
        { "t": "13:30", "title": "å¤§æ¾³æ¼æ‘", "c": "<b>äº¤é€šï¼š</b>æ˜‚åªå·´å£«ç¸½ç«™æ­<b>21è™Ÿå·´å£«</b> (ç´„20åˆ†)ã€‚<br><b>é«”é©—ï¼š</b>1. æ­å°è‰‡çœ‹æ£šå±‹æµ·è±š($20) 2. å¤§æ¾³é¤…åº—æ²™ç¿ 3. ç‚­ç‡’é›è›‹ä»”", "lat": 22.2535, "lng": 113.8630, "move": "bus" },
        { "t": "16:30", "title": "è¿”å›æ±æ¶Œ & å–è¡Œæ", "c": "<b>äº¤é€šï¼š</b>å¤§æ¾³å·´å£«ç¸½ç«™æ­<b>11è™Ÿå·´å£«</b> (ç´„50åˆ†)ã€‚<br>ä¸‹è»Šé»ç‚ºæ±æ¶Œç«™å·´å£«ç¸½ç«™ï¼Œæ—é‚Šå³æ˜¯æ±è–ˆåŸå–è¡Œæã€‚", "lat": 22.2895, "lng": 113.9410, "move": "bus" },
        { "t": "17:30", "title": "Bakehouse (æ±è–ˆåŸåº—)", "c": "<b>é¢¨éšªæç¤ºï¼š</b>ä¸‹åˆè›‹å¡”æ¥µå¯èƒ½å®Œå”®ï¼å»ºè­°æ—©ä¸Šå¯„ç‰©æ™‚å…ˆè²·/é è¨‚ã€‚è‹¥å‚æ™šæ‰è²·ï¼Œè¦æœ‰å¿ƒç†æº–å‚™ã€‚", "lat": 22.2895, "lng": 113.9410, "tag": "alert", "move": "walk" },
        { "t": "19:00", "title": "å‰å¾€æ©Ÿå ´ (BR810)", "c": "æ­ <b>S1 å·´å£«</b> (ç´„15åˆ†) è‡³æ©Ÿå ´ä¸€è™Ÿå®¢é‹å¤§æ¨“ã€‚<br>é è¨ˆ 19:20 æŠµé”ï¼Œè·é›¢ 21:50 èµ·é£›éå¸¸å……è£•ã€‚", "lat": 22.3080, "lng": 113.9185, "save": "Safe", "move": "bus" }
      ]
    }
  ]
};

// é—œé–‰æ‰€æœ‰ Modals
function closeAllModals() {
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
    document.querySelectorAll('.day-group').forEach(d => {
        d.classList.remove('active');
        d.querySelector('.toggle').innerText = 'â–¼';
    });
}

// é–‹é—œ VJW Modal
function toggleVjwModal() {
    const modal = document.getElementById('vjw-modal');
    modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
}

// å–®ä¸€å±•é–‹è¡Œç¨‹
function toggleDay(event) {
    const header = event.currentTarget;
    const currentGroup = header.parentElement;
    const isActive = currentGroup.classList.contains('active');
    closeAllModals(); // æ”¶åˆå…¶ä»–
    if (!isActive) {
        currentGroup.classList.add('active');
        header.querySelector('.toggle').innerText = 'â–²';
    }
}

// é–‹å•Ÿåœ°åœ–
function openMap(lat, lng, name) {
    let query = name;
    if (!/ç«™|æ©Ÿå ´|ç¥ç¤¾|å¯º|å¸‚|å¸‚å ´|æ©‹|åŸ|æ¹–|å²³|å®®|é…’åº—|é£¯åº—/i.test(name)) {
        query += " é¦™æ¸¯";
    }
    window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}&ll=${lat},${lng}`, '_blank');
}

// è¨ˆç®—è·é›¢ (Haversine)
function getDistance(lat1, lon1, lat2, lon2) {
    if (!lat1 || !lat2) return 0;
    const R = 6371; 
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
              Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return (R * c).toFixed(1);
}

// å–å¾—äº¤é€š Icon
function getMoveIcon(mode) {
    switch(mode) {
        case 'walk': return 'ğŸš¶';
        case 'mtr': return 'ğŸš‡';
        case 'bus': return 'ğŸšŒ';
        case 'ship': return 'â›´ï¸';
        case 'taxi': return 'ğŸš•';
        case 'plane': return 'âœˆï¸';
        case 'cable': return 'ğŸš¡';
        default: return 'ğŸš—';
    }
}

// Modal
function openModal(e) {
    const key = e.currentTarget.dataset.modal;
    let title = "", info = "", benefits = "";

    if (key === 'emergency' && tripData.emergency) {
        title = tripData.emergency.title;
        info = tripData.emergency.info;
    } else if (tripData.passes[key]) {
        title = tripData.passes[key].title;
        info = tripData.passes[key].info;
        benefits = tripData.passes[key].benefits;
    } else {
        return;
    }

    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-info').innerHTML = info;
    document.getElementById('modal-benefits').textContent = benefits || '';
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
    document.getElementById('modal').style.display = 'flex';
}

// Render
function render() {
    document.title = tripData.title;
    document.getElementById('header-title').textContent = tripData.title;
    document.getElementById('header-subtitle').textContent = tripData.subtitle;
    if(tripData.flight && tripData.flight.enabled) {
        document.getElementById('flight-info').textContent = tripData.flight.info;
    }

    // Passes
    const passBar = document.getElementById('passBar');
    let passHTML = '';
    for (const [key, p] of Object.entries(tripData.passes)) {
        passHTML += `<div class="pass-tag ${key}" data-modal="${key}">${p.tag}</div>`;
    }
    if (tripData.emergency) {
        passHTML += `<div class="pass-tag emergency" data-modal="emergency">ç·Šæ€¥è¯çµ¡</div>`;
    }
    passBar.innerHTML = passHTML;

    document.querySelectorAll('.pass-tag[data-modal]').forEach(tag => {
        tag.addEventListener('click', openModal);
    });

    if (tripData.vjw && tripData.vjw.enabled) {
        document.getElementById('vjw-img-container').innerHTML = `<img src="${tripData.vjw.image}" alt="QR Code">`;
    }

    // Timeline
    const timeline = document.getElementById('timeline');
    let html = '';

    tripData.days.forEach(day => {
        let spotsHTML = '';
        let prevLat = null, prevLng = null;

        day.spots.forEach((s, index) => {
            let tags = '';
            if (s.pass) tags += `<span class="tag pass">${s.pass}</span>`;
            if (s.save) tags += `<span class="tag save">${s.save}</span>`;
            
            let mapBtn = '';
            let distHTML = '';
            
            if (s.lat && s.lng) {
                mapBtn = `<button class="map" onclick="event.stopPropagation();openMap(${s.lat},${s.lng},'${s.title.replace(/'/g,"\\'")}')">åœ°åœ–</button>`;
                
                // è·é›¢ & äº¤é€šæ–¹å¼
                if (index > 0 && prevLat && prevLng) {
                    const dist = getDistance(prevLat, prevLng, s.lat, s.lng);
                    const moveIcon = getMoveIcon(s.move);
                    distHTML = `<div class="dist-display"><span class="dist-icon">${moveIcon}</span> è·ä¸Šä¸€ç«™: ${dist} km</div>`;
                } else if (index === 0 && s.move === 'plane') {
                     distHTML = `<div class="dist-display"><span class="dist-icon">âœˆï¸</span> å•Ÿç¨‹</div>`;
                }

                prevLat = s.lat;
                prevLng = s.lng;
            }

            let typeClass = s.type ? s.type : '';
            if (s.tag === 'alert') {
                tags += `<span class="tag alert">é¢¨éšªæç¤º</span>`;
            }

            spotsHTML += `
            <div class="spot ${typeClass}" onclick="this.classList.toggle('done')">
                <div class="time">${s.t}</div>
                <div class="title">
                    <div style="display:flex;align-items:center;">
                        <div class="check"></div>
                        <span>${s.title}</span>
                    </div>
                    ${mapBtn}
                </div>
                ${distHTML}
                <div class="content">${s.c}</div>
                <div class="tags">${tags}</div>
            </div>`;
        });

        html += `
        <div class="day-group">
            <div class="day-header" onclick="toggleDay(event)">
                <div>
                    <div class="day-title">${day.d} ${day.title}</div>
                    <div style="font-size:12px;color:var(--sub)">${day.date}</div>
                </div>
                <div class="toggle">â–¼</div>
            </div>
            <div class="spots">${spotsHTML}</div>
        </div>`;
    });

    timeline.innerHTML = html;
    if (tripData.footer && tripData.footer.enabled) {
        document.getElementById('footer').innerHTML = tripData.footer.text;
    }
}

window.addEventListener('scroll', () => {
    const fab = document.getElementById('backToTop');
    if (window.scrollY > 300) fab.classList.add('show');
    else fab.classList.remove('show');
});

render();
</script>

</body>
</html>